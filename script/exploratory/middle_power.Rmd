```{r}
library(readr)
library(conText)
library(dplyr)
library(tidytext)
library(quanteda)
library(word2vec)
corpus <- read_csv("~/Desktop/UNGDC/data/processed/cleaned.csv") %>%
  select(-"...1")
glove <- readRDS("~/Desktop/UNGDC/data/embeddings/glove.rds")
meta <- read_csv("~/Desktop/UNGDC/data/processed/meta.csv") 

text <- corpus(corpus)
toks <- tokens(text, 
               remove_punct=T, 
               remove_symbols=T, 
               remove_numbers=T, 
               remove_separators=T)

toks_nostop <- tokens_select(toks, 
                             pattern = stopwords("en"), 
                             selection = "remove", min_nchar=3)

feats <- dfm(toks_nostop, 
             tolower=T, 
             verbose = FALSE) 

toks_nostop_feats <- tokens_select(toks_nostop, feats, padding = TRUE)

toks_ngrams <- tokens_ngrams(toks_nostop_feats, n = 2)
dfm_ngrams <- dfm(toks_ngrams) 

if ("middle_power" %in% featnames(dfm_ngrams)) {
  middle_power_counts <- dfm_ngrams[, "middle_power"]
  
  middle_power_counts_df <- as.data.frame(as.matrix(middle_power_counts))
  colnames(middle_power_counts_df) <- "middle_power_count"
  
  middle_power_counts_df$document <- rownames(middle_power_counts_df)
  
  docs_with_middle_power <- subset(middle_power_counts_df, middle_power_count > 0)
  
  doc_ids <- docs_with_middle_power$document
  
  print(doc_ids)
} else {
  cat("The feature 'middle_power' does not exist in the DFM.\n")
}


```


