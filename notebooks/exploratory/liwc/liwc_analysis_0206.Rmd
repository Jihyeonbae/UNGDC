---
title: "liwc_modeling"
author: "Jihyeon bae"
date: "2024-02-06"
output: html_document
---

This script uses the scores of LIWC features and merges with country-year level meta data. With `liwc_df` dataset, at the country-year level, I run a series of statistical models that probe the relationship between invokation of key international norms and sentiment scores of that speech.

# Reading in the dataset

```{r setup, include=FALSE}
library(readr)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(countrycode)
library(lmtest)
library(collapse)
library(plm)

liwc_df<-read_csv("../../../data/interim/liwc_meta.csv")

#liwc_df<-liwc_df%>%
#  select(-X)%>%
#  select(-session)%>%
#  select(-ccode)%>%
#  select(-gwcode)

liwc_df$year<-as.numeric(liwc_df$year)
```

# Key indicator variables
- Create binary variables that detect key word within one speech. 1 when detected, 0 otherwise.
```{r}

liwc_df <- liwc_df %>%
  mutate(sovereignty = ifelse(str_detect(text, "sovereignty"), 1, 0),
         intervention = ifelse(str_detect(text, "intervention"), 1, 0),
         human_rights = ifelse(str_detect(text, "human rights"), 1, 0)) %>%
  mutate(sovereignty_count = str_count(text, "sovereignty"),
         intervention_count = str_count(text, "intervention"),
         human_rights_count = str_count(text, "human rights"))

         
```

## Modeling
```{r}
model0 <-plm( Authentic~ democracy + human_rights,
            data = liwc_df,
            index = c("ccode_iso", "year"),
            model = "within"
)
summary(model0, vcovBK(model0))

model1 <-plm(emo_neg ~ sovereignty * democracy + wdi_gdpcapcon2015 + cow_num_civil +
               cow_num_inter + kofgi_dr_eg + v2x_libdem,
             data = liwc_df,
             index = c("ccode_iso", "year"),
             model = "within"
)
summary(model1, vcovBK(model1))

model2 <-plm(sovereignty_count ~ democracy + wdi_gdpcapcon2015 + cow_num_civil +
               cow_num_inter + kofgi_dr_eg + v2x_libdem,
             data = liwc_df,
             index = c("ccode_iso", "year"),
             model = "within"
)
summary(model2, vcovBK(model2))

model3 <-plm(human_rights_count ~ v2x_polyarchy + wdi_gdpcapcon2015 + cow_num_civil +
               cow_num_inter + kofgi_dr_eg + v2x_libdem,
             data = liwc_df,
             index = c("ccode_iso", "year"),
             model = "within"
)
summary(model3, vcovBK(model3))


```

An increase in sovereignty is associated with an increase in the emo_neg outcome variable.
An increase in democracy is associated with an increase in the emo_neg outcome variable.
Plus, the relationship between sovereignty and emo_neg depends on the level of democracy. Specifically, an increase in sovereignty is associated with a decrease in emo_neg when democracy increases. When a country is considered to be democracy (with the conventional threshold of 0.5 of vdem_polyarchy score), invocation of sovereignty is correalted to negative emotion words to a lesser degree. 

```{r}
model4 <-plm(Authentic ~ ipron + emo_neg ,
             data = liwc_df,
             index = c("ccode_iso", "year"),
             model = "within"
)
summary(model4, vcovBK(model4))


model5 <- plm(democracy ~ Analytic + Clout + Tone + WPS + BigWords + Dic + Linguistic +
                pronoun + ppron + i + we + you + shehe + they + ipron + det + article + number + prep + auxverb + adverb + conj + negate + verb + adj + quantity + Drives + affiliation + achieve + power + Cognition + insight + Affect + emotion + Social + Culture + politic + ethnicity + tech + Lifestyle + female + Physical + Perception + Conversation,
              data = liwc_df,
              index = c("ccode_iso", "year"),
              model = "within"
)


summary(model5, vcovBK(model5))

x<-colnames(liwc_df[, 2:126])
model5<-plm(liwc_df$democracy ~ ., liwc_df[, 2:126],
              model = "within")



```
